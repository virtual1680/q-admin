<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title><%- title %></title>
		<style>
			html,
			body,
			#app {
				height: 100%;
				padding: 0;
				margin: 0;
			}
			.chromeframe {
				padding: 0.2em 0;
				margin: 0.2em 0;
				color: #000000;
				background: #cccccc;
			}
			#loader-wrapper {
				position: fixed;
				top: 0;
				left: 0;
				z-index: 999999;
				width: 100%;
				height: 100%;
			}
			#loader {
				position: relative;
				top: 50%;
				left: 50%;
				/* Chrome, Firefox 16+, IE 10+, Opera */
				z-index: 1001;
				display: block;
				width: 120px;
				height: 120px;
				margin: -75px 0 0 -75px;
				border: 3px solid transparent;
				/* COLOR 1 */
				border-top-color: #ffffff;
				border-radius: 50%;
				animation: spin 2s linear infinite;
			}
			#loader::before {
				position: absolute;
				top: 5px;
				right: 5px;
				bottom: 5px;
				left: 5px;
				content: '';
				border: 3px solid transparent;
				/* COLOR 2 */
				border-top-color: #ffffff;
				border-radius: 50%;
				animation: spin 3s linear infinite;
			}
			#loader::after {
				position: absolute;
				top: 15px;
				right: 15px;
				bottom: 15px;
				left: 15px;
				content: '';
				border: 3px solid transparent;
				border-top-color: #ffffff;
				border-radius: 50%;
				/* COLOR 3 */
				animation: spin 1.5s linear infinite;
			}
			@keyframes spin {
				0% {
					transform: rotate(0deg);
				}
				100% {
					transform: rotate(360deg);
				}
			}
			#loader-wrapper .loader-section {
				position: fixed;
				top: 0;
				/* Old browsers */
				z-index: 1000;
				width: 51%;
				height: 100%;
				background: #49a9ee;
				transform: translateX(0);
			}
			#loader-wrapper .loader-section.section-left {
				left: 0;
			}
			#loader-wrapper .loader-section.section-right {
				right: 0;
			}

			/* Loaded */
			.loaded #loader-wrapper .loader-section.section-left {
				/* Firefox 16+, IE 10+, Opera */
				transition: all 0.7s 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);
				transform: translateX(-100%);
			}
			.loaded #loader-wrapper .loader-section.section-right {
				/* Firefox 16+, IE 10+, Opera */
				transition: all 0.7s 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);
				transform: translateX(100%);
			}
			.loaded #loader {
				opacity: 0;
				transition: all 0.3s ease-out;
			}
			.loaded #loader-wrapper {
				visibility: hidden;
				/* Firefox 16+, IE 10+, Opera */
				transition: all 0.3s 1s ease-out;
				transform: translateY(-100%);
			}

			/* JavaScript Turned Off */
			.no-js #loader-wrapper {
				display: none;
			}
			.no-js h1 {
				color: #222222;
			}
			#loader-wrapper .load_title {
				position: absolute;
				top: 60%;
				z-index: 9999999999999;
				width: 100%;
				font-family: 'Open Sans';
				font-size: 14px;
				line-height: 30px;
				color: #ffffff;
				text-align: center;
				opacity: 1;
			}
			#loader-wrapper .load_title span {
				font-size: 14px;
				font-style: italic;
				font-weight: normal;
				color: #ffffff;
				opacity: 0.5;
			}

			/* 滚动条优化 start */
			::-webkit-scrollbar {
				width: 8px;
				height: 8px;
			}
			::-webkit-scrollbar-track {
				background: #f6f6f6;
				border-radius: 2px;
			}
			::-webkit-scrollbar-thumb {
				background: #cdcdcd;
				border-radius: 2px;
			}
			::-webkit-scrollbar-thumb:hover {
				background: #747474;
			}
			::-webkit-scrollbar-corner {
				background: #f6f6f6;
			}

			/* 滚动条优化 end */
		</style>
		<script>
			window._CONFIG = {};
		</script>
	</head>
	<body>
		<div id="app">
			<div id="loader-wrapper">
				<div id="loader"></div>
				<div class="loader-section section-left"></div>
				<div class="loader-section section-right"></div>
				<div class="load_title">正在加载 <%- title %></div>
			</div>
		</div>
		<script type="module" src="/src/main.ts"></script>
		<script>
			(function () {
				handleAddListener('load', getTiming);
				function handleAddListener(type, fn) {
					if (window.addEventListener) {
						window.addEventListener(type, fn);
					} else {
						window.attachEvent('on' + type, fn);
					}
				}
				function getTiming() {
					try {
						var time = performance.timing;
						var timingObj = {};
						var loadTime = (time.loadEventEnd - time.loadEventStart) / 1000;
						if (loadTime < 0) {
							setTimeout(function () {
								getTiming();
							}, 200);
							return;
						}
						timingObj['重定向时间'] = (time.redirectEnd - time.redirectStart) / 1000;
						timingObj['DNS解析时间'] = (time.domainLookupEnd - time.domainLookupStart) / 1000;
						timingObj['TCP完成握手时间'] = (time.connectEnd - time.connectStart) / 1000;
						timingObj['HTTP请求响应完成时间'] = (time.responseEnd - time.requestStart) / 1000;
						timingObj['DOM开始加载前所花费时间'] = (time.responseEnd - time.navigationStart) / 1000;
						timingObj['DOM加载完成时间'] = (time.domComplete - time.domLoading) / 1000;
						timingObj['DOM结构解析完成时间'] = (time.domInteractive - time.domLoading) / 1000;
						timingObj['脚本加载时间'] = (time.domContentLoadedEventEnd - time.domContentLoadedEventStart) / 1000;
						timingObj['onload事件时间'] = (time.loadEventEnd - time.loadEventStart) / 1000;
						timingObj['页面完全加载时间'] =
							timingObj['重定向时间'] +
							timingObj['DNS解析时间'] +
							timingObj['TCP完成握手时间'] +
							timingObj['HTTP请求响应完成时间'] +
							timingObj['DOM结构解析完成时间'] +
							timingObj['DOM加载完成时间'];

						for (item in timingObj) {
							console.log(item + ':' + timingObj[item] + '毫秒(ms)');
						}
						console.log(performance.timing);
					} catch (e) {
						console.log(timingObj);
						console.log(performance.timing);
					}
				}
			})();
		</script>
	</body>
</html>
